#!/usr/bin/env node
"use strict";

var _fs = _interopRequireDefault(require("fs"));

var _yargs = _interopRequireDefault(require("yargs"));

var _CFTemplate = _interopRequireDefault(require("../lib/CFTemplate"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const yargs = _yargs.default.usage('Usage: cftemplate [options] <dir>').demandCommand(1, 'must provide a valid dir').options({
  e: {
    alias: 'entry',
    default: 'index.yml',
    describe: 'entry point file name',
    type: 'string'
  },
  o: {
    alias: 'output',
    describe: 'output file name',
    type: 'string'
  }
}).help('help').alias('help', 'h');

const argv = yargs.argv;

(async () => {
  try {
    const data = await _CFTemplate.default.build({
      dir: argv._[0],
      entry: argv.entry
    });

    if (argv.o) {
      _fs.default.writeFileSync(argv.o, data);
    } else {
      console.log(data);
    }
  } catch (error) {
    console.error(error.message);
    process.exit(1);
  }

  process.exit(0);
})();